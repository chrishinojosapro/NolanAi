<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nolan AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
    /* NOLAN DARK THEME */
    :root {
        --bg: #0f0f0f; 
        --surface: #1a1a1a; 
        --text: #e0e0e0;
        --user: #1e88e5; /* Blue */
        --ai: #00897b;   /* Teal */
        --accent: #00e676; /* Green Accent */
    }
    body { font-family: 'Roboto', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; justify-content: center; height: 100vh; overflow: hidden; }
    
    #terminal { 
        width: 100%; max-width: 800px; 
        display: flex; flex-direction: column; 
        background: var(--surface); 
        height: 100%; 
        box-shadow: 0 0 30px rgba(0,0,0,0.7); 
    }
    
    #header {
        padding: 15px 20px;
        background: #222;
        border-bottom: 1px solid #333;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .status-dot { height: 10px; width: 10px; background: var(--accent); border-radius: 50%; display: inline-block; margin-right: 5px; box-shadow: 0 0 5px var(--accent); }

    #log { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; scroll-behavior: smooth; }
    
    .row { display: flex; align-items: flex-end; animation: fadeIn 0.3s ease; }
    .row.user { justify-content: flex-end; }
    .row.ai { justify-content: flex-start; }
    
    .bubble { max-width: 80%; padding: 14px 18px; border-radius: 18px; line-height: 1.5; font-size: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
    .user .bubble { background: var(--user); color: #fff; border-bottom-right-radius: 2px; }
    .ai .bubble { background: #2d2d2d; color: #fff; border-bottom-left-radius: 2px; }
    
    .avatar { width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin: 0 12px; font-size: 14px; flex-shrink: 0; }
    .user .avatar { background: var(--user); order: 2; }
    .ai .avatar { background: var(--ai); order: 1; }

    #controls { padding: 20px; background: #222; border-top: 1px solid #333; display: flex; gap: 12px; }
    
    input { 
        flex: 1; padding: 16px; 
        border-radius: 30px; border: 1px solid #444; 
        background: #111; color: white; 
        font-size: 16px; outline: none; 
        transition: border 0.2s;
    }
    input:focus { border-color: var(--accent); }
    
    button { 
        padding: 0 25px; border-radius: 30px; border: none; 
        background: var(--accent); color: #000; 
        font-weight: bold; font-size: 14px; letter-spacing: 1px;
        cursor: pointer; transition: transform 0.1s, opacity 0.2s; 
    }
    button:active { transform: scale(0.95); }
    button:disabled { background: #555; cursor: not-allowed; }
    
    .typing { font-style: italic; opacity: 0.6; font-size: 13px; margin-left: 60px; margin-bottom: 5px; display: none; color: var(--accent); }
    .typing.show { display: block; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>

<div id="terminal">
    <div id="header">
        <span>NOLAN AI SYSTEM</span>
        <span style="font-size: 12px; font-weight: normal;"><span class="status-dot"></span>ONLINE</span>
    </div>

    <div id="log">
        <div class="row ai">
            <div class="avatar">N</div>
            <div class="bubble">System Initialized. I'm Nolan. How can I help?</div>
        </div>
    </div>
    
    <div class="typing" id="indicator">Nolan is thinking...</div>
    
    <div id="controls">
        <input type="text" id="msg" placeholder="Type a message..." autocomplete="off">
        <button id="send">SEND</button>
    </div>
</div>

<script>
    // ---------------------------------------------------------
    // AUTOMATICALLY CONFIGURED WITH YOUR NEW URL
    // ---------------------------------------------------------
    const API_URL = "https://script.google.com/macros/s/AKfycbz_sAxSjXKT1gjdxwvnIEniuSXHzBDfdI3rrCOnFpkO1wcn0VgHNKl_VBpFxkfS6mwt/exec"; 

    const input = document.getElementById('msg');
    const btn = document.getElementById('send');
    const log = document.getElementById('log');
    const indicator = document.getElementById('indicator');

    input.addEventListener('keypress', (e) => { if(e.key === 'Enter') send(); });
    btn.addEventListener('click', send);

    function addMsg(text, type) {
        const row = document.createElement('div');
        row.className = `row ${type}`;
        
        const avatar = document.createElement('div');
        avatar.className = 'avatar';
        avatar.innerText = type === 'user' ? 'Y' : 'N';
        
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        bubble.innerText = text;
        
        row.appendChild(avatar);
        row.appendChild(bubble);
        log.appendChild(row);
        log.scrollTop = log.scrollHeight;
    }

    async function send() {
        const txt = input.value.trim();
        if(!txt) return;

        // 1. Add User Message
        addMsg(txt, 'user');
        input.value = '';
        input.disabled = true;
        btn.disabled = true;
        indicator.classList.add('show');

        try {
            // 2. Send to Google Apps Script
            const res = await fetch(API_URL, {
                method: "POST",
                headers: { "Content-Type": "text/plain" }, 
                body: JSON.stringify({ message: txt })
            });

            if (!res.ok) throw new Error(`Server Error: ${res.status}`);

            const data = await res.json();
            
            // 3. Add Nolan's Reply
            addMsg(data.reply, 'ai');

        } catch (error) {
            console.error(error);
            addMsg("Connection Error: Unable to reach Nolan's Mainframe.", 'ai');
        } finally {
            input.disabled = false;
            btn.disabled = false;
            input.focus();
            indicator.classList.remove('show');
        }
    }
</script>

</body>
</html>
